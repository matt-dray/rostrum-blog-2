{
  "hash": "db49eb638bff20c694747fa7db2e00cc",
  "result": {
    "markdown": "---\ntitle: 'Ding! Sound effects in {r.oguelike}'\nauthor: Matt Dray\ndate: '2023-01-04'\nslug: rogue-sfx\ncategories:\n  - code\n  - package\ntags:\n  - r\n  - r.oguelike\n  - sonify\n  - video\ndraft: no\n---\n\n\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/HD1cPWcQUc4\" title=\"Demo of {r.oguelike} for R\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n<p class=\"caption\">new wr — r.oguelike any% tenkeyless noglitch</p>\n\n# tl;dr\n\n[The {r.oguelike} package](https://github.com/matt-dray/r.oguelike)---a toy roguelike microadventure for the R console---now has little sound effects [thanks to {sonify}](https://cran.r-project.org/package=sonify). Pew pew!\n\n# The adventure continues?\n\nApparently this is part 5 of the {r.oguelike} [devlog](https://en.wiktionary.org/wiki/devlog). You can read earlier posts about:\n\n* [its inception](https://www.rostrum.blog/2022/04/25/r.oguelike-dev/)\n* [creating simple procedural dungeons](https://www.rostrum.blog/2022/05/01/dungeon/)\n* [making an enemy chase the player](https://www.rostrum.blog/2022/06/10/basic-search/)\n* [3D dungeons and continuous keypress inputs](https://www.rostrum.blog/2022/06/28/isometric-dungeon/)\n\nAlas, this is also probably the last installment. \n\nYes, the dungeons have been dank (cool, edgy), but also _dank_ (cool, damp, claustrophobic). Time to unspelunk myself.\n\nThere may be time for a {r.oguelike2} in future. I'd like to try a class-based approach to help limit code spaghetti and make it more extensible. Perhaps it will even have a proper game loop! Call me when you're ready, Kojima.\n\nUntil then, one more little feature to tie things up. Beeeeeeep. BOOOOOOOP.\n\n# Hi-Sonifi\n\nSo, yes: {r.oguelike} now has sound effects with quality as high as its graphics and gameplay. See all these in concert in the video embedded at the top of this page.\n\nI used [the {sonify} package](https://cran.r-project.org/package=sonify) to create a few little beeps and toots that I think fit the game's retro aesthetic.[^mikefc] These are fired when the player moves and interacts with things in the dungeon.\n\nI've written about {sonify} before when I sonified data about [COVID-19 infections](https://www.rostrum.blog/2021/02/02/sonify-covid/) and [GitHub activity](https://www.rostrum.blog/2021/02/21/skyphone/) (incredible juxtaposition), which can offer a more interesting and accessible way of presenting data.\n\nYou can also demean {sonify} by making funny little honks and parps, which is what I've done for {r.oguelike}.\n\nHow did I arrive at the soundscape for {r.oguelike}? I did the bare minimum of fiddling around with the arguments in `sonify::sonify()` until the noises amused me.\n\n# Demo cassette\n\nSounds are played in the code of the package via functions after each triggering event. The user can prevent these sounds from playing with the logical `has_sfx` argument in the `start_game()` function.\n\nFor example, here's the function for the simplest sound effect:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n.sfx_move <- function(has_sfx) {\n  if (has_sfx) sonify::sonify(1, 1, duration = 0.001)\n}\n```\n:::\n\n\nThe `sonify()` outputs are [{tuneR}](https://CRAN.R-project.org/package=tuneR) objects. I've saved these as wav files with `tuneR::writeWav()` so they can be embedded in this post.\n\n<details><summary>Click for illustrative code to create the wav files.</summary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sonify)\nlibrary(tuneR)\nlibrary(purrr)\n\nsfx <- list(\n  \n  move = sonify(1, 1, duration = 0.001),\n  \n  bump = sonify(1, 1, duration = 0.01, flim = c(100, 110)),\n  \n  gold = bind(\n    sonify(1, 1, duration = 0.05, flim = c(800, 800)),\n    sonify(1, 1, duration = 0.05, flim = c(1000, 1000))\n  ),\n  \n  apple = sonify(0:1, c(0, 1), duration = 0.05),\n  \n  eat = sonify(0:1, c(1, 0), duration = 0.05),\n  \n  win = bind(\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600)),\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600)),\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(800, 800))\n  ),\n  \n  lose = bind(\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600)),\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600)),\n    sonify(0:1, rep(1, 2), duration = 0.1, flim = c(400, 400))\n  )\n  \n)\n\nwalk2(\n  .x = sfx,\n  .y = names(sfx), \n  ~writeWave(.x, paste0(.y, \".wav\"))\n)\n```\n:::\n\n\n</details>\n\nIn reality, the sounds play a little slower in the game itself, but it was a bit fiddly to reproduce it for these clips. You'll get the idea.\n\n## Move\n\nStep onto unoccupied floor tile (`.`) and you'll hear the very quick tap of your boot.\n\nClick to play the sound:\n\n<html><audio controls><source src=\"/output/rogue-sfx/move.wav\" type=\"audio/wav\"></audio></html>\n\nAnd here's the corresponding code to reproduce it:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(1, 1, duration = 0.001)\n```\n:::\n\n\nBut bump into the dungeon wall (`#`) and you'll get a dull thud, you absolute clod.\n\n<html><audio controls><source src=\"/output/rogue-sfx/bump.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(1, 1, duration = 0.01, flim = c(100, 110))\n```\n:::\n\n\nYes, `flim`, as in: 'this post is absolute flimflam'.\n\n## Food\n\nWould you pick up an apple (`a`) you found on the floor of a cave? Here's what it might sound like as it pops into your inventory.\n\n<html><audio controls><source src=\"/output/rogue-sfx/apple.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(0:1, c(0, 1), duration = 0.05),\n```\n:::\n\n\nMore importantly, would you eat an apple (`a`) you found on the floor of a cave? Here's how it would sound as it rolls down your gullet.\n\n<html><audio controls><source src=\"/output/rogue-sfx/eat.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(0:1, c(1, 0), duration = 0.05)\n```\n:::\n\n\n## Gold\n\nCollecting gold (`$`) grants you a celebratory chirp of excitement. Although there's not actually anything in the dungeon to spend it on, sorry.\n\n<html><audio controls><source src=\"/output/rogue-sfx/gold.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(1, 1, duration = 0.05, flim = c(800, 800))\nsonify(1, 1, duration = 0.05, flim = c(1000, 1000))\n```\n:::\n\n\n## Defeat enemy\n\nA powerful victory ditty after you crush your enemies (`E`).\n\n<html><audio controls><source src=\"/output/rogue-sfx/win.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600))\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600))\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(800, 800))\n```\n:::\n\n\n## Lose\n\nConversely, a sad lament for being crushed by your enemies (`E`) or running out of turns (`T`).\n\n<html><audio controls><source src=\"/output/rogue-sfx/lose.wav\" type=\"audio/wav\"></audio></html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600))\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(600, 600))\nsonify(0:1, rep(1, 2), duration = 0.1, flim = c(400, 400))\n```\n:::\n\n\n# Echo echo echo\n\nIf you want to try out {r.oguelike}, you can install it from GitHub:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.github(\"remotes\")  # if not yet installed\nremotes::install_github(\"matt-dray/r.oguelike\")  # v0.1 currently\nr.oguelike::start_game()\n```\n:::\n\n\nYou can also [run {r.oguelike} in an RStudio instance in your browser](https://mybinder.org/v2/gh/matt-dray/play-r.oguelike/main?urlpath=rstudio) (!), thanks to [the Binder project](https://mybinder.org/).\n\nFree feel to highlight any bugs via [the issues](https://github.com/matt-dray/rostrum-blog/issues), or create a pull request that adds all the things that stop me from calling {r.oguelike} a proper 'game'.[^game]\n\n<a href=\"https://github.com/matt-dray/r.oguelike\"><div class=\"figure\">\n<img src=\"/post/2022-04-30-dungeon_files/r.oguelike-hex.png\" alt=\"Hex sticker design for the 'r.oguelike' R package. Black background with bright green font, reminiscent of old computer terminal output. In the centre, a three-by-ten arrangement of hashmarks and periods, along with a single at symbol and dollar sign, which looks like a classic ACII tile-based roguelike game. The text 'r.oguelike' is underneath.\" width=\"25%\"/>\n</div></a>\n\nMost importantly, don't forget to wishlist me on Steam and remember that pre-order bonuses will include an apple that's been left on a dungeon floor for a few months.\n\n\n---\n<details><summary>Session info</summary>\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.0 (2022-04-22)\n os       macOS Big Sur/Monterey 10.16\n system   x86_64, darwin17.0\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/London\n date     2023-04-10\n pandoc   2.19.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cli           3.6.0   2023-01-09 [1] CRAN (R 4.2.0)\n digest        0.6.31  2022-12-11 [1] CRAN (R 4.2.0)\n evaluate      0.20    2023-01-17 [1] CRAN (R 4.2.0)\n fastmap       1.1.0   2021-01-25 [1] CRAN (R 4.2.0)\n htmltools     0.5.2   2021-08-25 [1] CRAN (R 4.2.0)\n htmlwidgets   1.5.4   2021-09-08 [1] CRAN (R 4.2.0)\n jsonlite      1.8.4   2022-12-06 [1] CRAN (R 4.2.0)\n knitr         1.42    2023-01-25 [1] CRAN (R 4.2.0)\n rlang         1.0.6   2022-09-24 [1] CRAN (R 4.2.0)\n rmarkdown     2.14    2022-04-25 [1] CRAN (R 4.2.0)\n rstudioapi    0.14    2022-08-22 [1] CRAN (R 4.2.0)\n sessioninfo   1.2.2   2021-12-06 [1] CRAN (R 4.2.0)\n xfun          0.37    2023-01-31 [1] CRAN (R 4.2.0)\n yaml          2.3.7   2023-01-23 [1] CRAN (R 4.2.0)\n\n [1] /Library/Frameworks/R.framework/Versions/4.2/Resources/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n</details>\n\n[^mikefc]: Meanwhile, I'm looking forward to what [Mike (coolbutuseless) is up to with audio for games in R](https://twitter.com/coolbutuseless/status/1561664096860524545).\n[^game]: Find some actual real R games in [this list I've put together](https://github.com/matt-dray/awesome-r-games).",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}