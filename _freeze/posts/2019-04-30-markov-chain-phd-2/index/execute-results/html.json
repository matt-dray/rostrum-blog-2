{
  "hash": "998e43083efc70fd056f19910ea0a3f6",
  "result": {
    "markdown": "---\ntitle: Markov-chaining my PhD thesis II\nauthor: Matt Dray\ndate: 2019-04-30\nslug: markov-chain-phd-2\ncategories:\n  - furrr\n  - markovifyR\n  - phd\n  - r\n  - text\n---\n\n\n![This is science, I promise.](resources/leaf-ash.jpg){fig-alt=\"An overhead view of many circular vessels in a grid pattern that hold leaf fragments.\" width=\"100%\"}\n\n## tl;dr\n\nIn which a Markov chain perfectly summarises [my entire PhD thesis](https://orca.cf.ac.uk/68365/):\n\n>In general, litter chemical composition and decomposition.\n\n## {markovifyR}\n\n[I posted a while back](https://www.rostrum.blog/2018/06/30/markov-chain-phd/) about using [a Markov chain](https://hackernoon.com/from-what-is-a-markov-model-to-here-is-how-markov-models-work-1ac5f4629b71) to generate sentences using [my PhD thesis](https://orca.cf.ac.uk/68365/) as input. I also posted about [the {markovifyR} package](https://github.com/abresler/markovifyR) for [generating lyrics by The Mountain Goats](https://www.rostrum.blog/2019/04/25/gen-tmg-lyrics/).\n\nThis is a quick update to that original post, but this time I'm using {markovifyR}.\n\n## Some code\n\nThe PhD text is available from my {dray} package on GitHub:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremotes::install_github(\"matt-dray/dray\")\n```\n:::\n\n\nI'll remove the blank lines and ignore the preamble and references section. As a reminder, the thesis is about the decomposition of tree litter that's been exposed to environmental stressors like elevated carbon dioxide levels and acidified streams.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphd_text <- dray::phd  # get data\nphd_text <- phd_text[nchar(phd_text) > 0]  # remove blank lines\nphd_text <- phd_text[27:376]  # ignore preamble and references\nphd_text[1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Acknowledgements\"                                                                                                   \n[2] \"The study of rotting detritus is not for the faint-hearted. I am indebted to many people for their help and advice.\"\n```\n:::\n:::\n\n\nNow to prepare the work space. {markovifyR} is a wrapper of the `markovify` Python module. You first need to install `markovify`. You can do this from the command line with `pip3 install markovify`, for example (though this will depend on the version of Python you have). You can also run command-line code from R with a call to `system()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsystem(\"pip3 install markovify\")\n```\n:::\n\n\nAnd then ensure you've installed {markovifyR} from GitHub and also the dependency {furrr}.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(markovifyR)   # remotes::install_github(\"abresler/markovifyR\")\nlibrary(furrr)  # install.packages(\"furrr\")\n```\n:::\n\n\nThe function `generate_markovify_model()` builds the model and `markovify_text()` generate some sentences based on that model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build model\nmarkov_model <- generate_markovify_model(\n  input_text = phd_text,\n  markov_state_size = 2L,\n  max_overlap_total = 25,\n  max_overlap_ratio = 0.7\n)\n\n# Generate lines\nphd_speak <- markovify_text(\n  markov_model = markov_model,\n  maximum_sentence_length = NULL,\n  output_column_name = \"phd_speak\",\n  count = 50,\n  tries = 50,\n  only_distinct = TRUE,\n  return_message = FALSE\n)\n\nhead(phd_speak)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  idRow phd_speak                                                               \n  <int> <chr>                                                                   \n1     1 Initial lignin concentrations after 268 days were compared by pairwise …\n2     2 5.3.1 Leaf litter growth condition on any measure of invertebrate feedi…\n3     3 It is, however, generally patchy in time and space, making it difficult…\n4     4 Specifically, it considers how elevated atmospheric CO2, and rural litt…\n5     5 Conversely to lignin, carbon and nutrient storage in both the aquatic s…\n6     6 Bag positions were randomised within each species were selected to repr…\n```\n:::\n:::\n\n\nI haven't spent much time tweaking the arguments in `generate_markovify_model()`, but the results are pretty amusing anyway.\n\n## Robo-thesis\n\nI ran this a few times and picked some favourites.\n\n| Output | Hot take |\n| :----- | :------- |\n| _In general, litter chemical composition and decomposition._ | This is the ultimate summary of my thesis. |\n| _This thesis is the total nitrogen content of the North American Benthological Society._ | I'm sure the NABS has more nitrogen in its possession. |\n| _This simplicity has allowed for broad underlying principles to be linked to litter chemical composition differently depending on whether it was exposed to a labeled 0.5 m steel rod._ | Holy smokes, who knew that the steel rods were the deciding factor? Were they radioactive or something? |\n| _Deciduous woodlands are dependent on the parent tree._ | Yes, all deciduous woodlands have one central master tree from which all the others are descended. |\n| _Currently there is a key ecosystem process in temperate deciduous woodlands and streams._ | Yes, but what is it? I must know! |\n| _Canadian Journal of the laboratory in a randomly-ordered 3 × 3 grid._ | That is one niche academic journal. |\n| _I am grateful for the choice test._ | I designed and ran it, so I have only myself to thank. |\n| _My parents have never wavered in their responses, suggesting that caution has to be available online in the CEF._ | It seems the Controlled Environment Facility (CEF) cannot control for the effect of parental input; best to provide some guidance on what to do if parental influence is strong. |\n| _Bonferroni-adjusted critical significance levels were compared by pairwise PERMANOVA._ | That sure sounds like statistics! |\n| _This reduced decomposition rate in the University’s Open Access repository and for inter-library loan, and for inter-library loan, and for inter-library loans._ | Ah good, slower-decomposing books will last longer; apparently this is important for inter-library loans? |\n\n## Very science, much thesis\n\nOnce again, simply copy and paste several of these sentences into your own thesis. The benefit is that you won't have to grow any trees in a high carbon-dioxide atmosphere; you won't have to spend months packing leaves into tiny bags; you won't have to attach those bags to tens of IKEA cutlery holders and dunk them in frozen streams in mid-Wales; you won't have to grind those leaves into a suspicious-looking powder and transport them cross-country for chemical analyses; you won't have to imprison any insects against their will. You are welcome.\n\nGood luck at your viva!\n\n## Environment {.appendix}\n\n<details><summary>Session info</summary>\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nLast rendered: 2023-08-02 14:11:58 BST\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.2.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] purrr_1.0.1      furrr_0.3.1      future_1.33.0    markovifyR_0.102\n\nloaded via a namespace (and not attached):\n [1] Matrix_1.5-4.1     jsonlite_1.8.7     dplyr_1.1.2        compiler_4.3.1    \n [5] plotrix_3.8-2      tidyselect_1.2.0   Rcpp_1.0.11        stringr_1.5.0     \n [9] parallel_4.3.1     png_0.1-8          globals_0.16.2     yaml_2.3.7        \n[13] fastmap_1.1.1      here_1.0.1         lattice_0.21-8     reticulate_1.30   \n[17] R6_2.5.1           generics_0.1.3     dray_0.0.0.9000    knitr_1.43.1      \n[21] htmlwidgets_1.6.2  tibble_3.2.1       rprojroot_2.0.3    pillar_1.9.0      \n[25] RColorBrewer_1.1-3 rlang_1.1.1        utf8_1.2.3         wordcloud_2.6     \n[29] stringi_1.7.12     xfun_0.39          cli_3.6.1          withr_2.5.0       \n[33] magrittr_2.0.3     grid_4.3.1         digest_0.6.33      rstudioapi_0.15.0 \n[37] lifecycle_1.0.3    vctrs_0.6.3        evaluate_0.21      glue_1.6.2        \n[41] listenv_0.9.0      codetools_0.2-19   parallelly_1.36.0  fansi_1.0.4       \n[45] gifski_1.12.0-1    rmarkdown_2.23     tools_4.3.1        pkgconfig_2.0.3   \n[49] htmltools_0.5.5   \n```\n:::\n:::\n\n</details>",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}